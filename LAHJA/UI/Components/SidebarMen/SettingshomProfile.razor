
@page "/settings/{*Url}"
@using LAHJA.Data.UI.Components.ProFileModel
@using LAHJA.UI.Components.SidebarMen.Settings
@using LAHJA.UI.Components.SidebarMen.USettings
@inherits ComponentBase
@inject NavigationManager NavigationManager
 
  
@* <ResendConfirmationemail />   *@

  


    @using MudBlazor


  
    @if(DataBuild!=null)
    {
  @*  <div class="container relative flex flex-col md:grid md:space-y-0 w-full md:grid-cols-12 space-y-4 md:gap-6 py-6" style=" margin-right: 15%;">
    <div class="md:col-span-4 lg:col-span-3">
        <section class="pt-6 border-gray-100 from-gray-50-to-white overflow-hidden rounded-xl border border-gray-100 bg-gradient-to-l">
            <a class="cols-span-9 mb-2 flex items-center px-4 pb-4" href="/735408478mm">
                <div class="relative flex-none">
                    <img alt="" class="rounded-full mr-3 size-12 flex-none overflow-hidden bg-gray-100 dark:bg-gray-900"
                         src="https://cdn-avatars.huggingface.co/v1/production/uploads/noauth/SXJTVYmE71adfaZsiGDsE.png">
                </div>



                <div class="my-1">
                    <h2 class="flex items-center text-lg/5 font-bold lg:text-xl/6">@DataBuild.Name</h2>
                    <div class="inline-block rounded bg-gray-200 px-1 font-mono text-xs dark:bg-gray-800">@DataBuild.Phone</div>
                </div>
            </a>
            <nav>
                <ul class="divide-y divide-gray-100 border-t border-gray-100 text-base text-gray-600" style="background-color:none!important">
                    @foreach (var item in NavItems)
                    {
                        <li>
                            <a href="@item.url" class="group relative flex items-center overflow-hidden px-2 py-1.5 dark:text-gray-400">
                                <div class="block rounded px-2 py-0.5 group-hover:bg-gray-100 dark:group-hover:bg-gray-800">@item.Label</div>
                                @if (!string.IsNullOrEmpty(item.Badge))
                                {
                                    <span class="ml-auto mr-1.5 rounded px-1.5 py-0.5 text-xs font-semibold leading-tight bg-blue-500/10 text-blue-700 dark:text-blue-200">@item.Badge</span>
                                }

                            </a>
                        </li>
                    }
                </ul>
            </nav>
        </section>

        <div slot="footer" class="mt-3 flex items-center gap-2 text-sm text-gray-400 lg:px-4">
            Upgrade to
            <a class="flex items-center border-b hover:border-gray-600 hover:text-gray-600 dark:border-gray-600 dark:hover:border-gray-200 dark:hover:text-gray-200" href="/settings/billing/subscription#subscribe">
                <svg class="mr-1" xmlns="http://www.w3.org/2000/svg" fill="none" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 12 12"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.198 1.961a3.164 3.164 0 0 1 1.711-.616h5.455c1.163 0 1.818.946 1.454 2.073l-1.672 5.164c-.364 1.127-1.637 2.072-2.837 2.072H1.855C.69 10.654 0 9.71.364 8.582l1.745-5.164A3.164 3.164 0 0 1 3.2 1.96Zm1.807 1.705L3.387 8.364h1.315l.513-1.49h.535c.346 0 .69-.057 1.03-.173.346-.115.652-.293.918-.534a2.2 2.2 0 0 0 .606-.94c.136-.395.15-.706.039-.932-.106-.227-.295-.388-.567-.484a2.853 2.853 0 0 0-.952-.145h-1.82Zm1.022 2.226h-.474l.428-1.243h.443c.255 0 .436.043.544.13.108.087.125.236.052.448a.977.977 0 0 1-.36.492c-.162.115-.373.173-.612.173Z" fill="currentColor"></path></svg> Pro
            </a>
        </div>
    </div>
    </div> *@



    <MudContainer Class="container relative flex flex-col md:grid md:space-y-0 w-full md:grid-cols-12 space-y-4 md:gap-6 py-6" style="margin-right: 15%; direction:ltr !important">
        <MudContainer Class="md:col-span-4 lg:col-span-3">
            <MudContainer Class="pt-6 border border-gray-100 rounded-xl bg-gradient-to-l overflow-hidden" style="background-color:none!important">
                <MudLink Href="/735408478mm" Class="cols-span-9 mb-2 flex items-center px-4 pb-4">
                    <MudImage Alt="" Class="rounded-full mr-3 size-12 flex-none overflow-hidden bg-gray-100 dark:bg-gray-900" Src="@data.ImageUrl" />
                    <div>
                        <MudText Typo="Typo.h5" Class="font-bold">@data.Name</MudText>
                        <MudChip Class="mt-1" T="object" Color="Color.Default" Variant="Variant.Outlined">@data.Phone</MudChip>
                    </div>
                </MudLink>
                <MudList T="string">
                    @foreach (var item in NavItems)
                    {
                        <MudListItem style="padding:0% !important; margin:10px !important" Text="@item.Label">
                            <MudNavLink style="padding:0% !important; margin:0px !important" Href="@item.Url" Match="NavLinkMatch.All" OnClick="() => SetActiveTab(item.Url)">
                                <MudText Typo="Typo.body2">@item.Label</MudText>
                                @if (!string.IsNullOrEmpty(item.Badge))
                                {
                                    <MudText Typo="Typo.caption" Class="ml-auto mr-1.5 rounded px-1.5 text-xs font-semibold leading-tight bg-blue-500/10 text-blue-700 dark:text-blue-200">@item.Badge</MudText>
                                }
                            </MudNavLink>
                        </MudListItem>
                    }
                </MudList>
            </MudContainer>
            <MudContainer Class="mt-3 flex items-center gap-2 text-sm text-gray-400">
                Upgrade to
                <MudLink Href="/settings/billing/subscription#subscribe" Class="flex items-center">
                    <MudIcon Icon="mdi-crown" Class="mr-1" />
                    Pro
                </MudLink>
            </MudContainer>
        </MudContainer>
        <MudContainer Class="md:col-span-8 lg:col-span-9 w-full border-1">
            <MudTabs Class="w-full">
                <MudTabPanel Class="w-full" Text="Content">
                    @if (!string.IsNullOrEmpty(Url))
                    {
                        @RenderComponentBasedOnUrl
                    }
                    else
                    {
                        <BillingSection />
                    }
                </MudTabPanel>
            </MudTabs>
        </MudContainer>
    </MudContainer>



  





    



    













}
else
{
    <h1>Error the element !!</h1>
}



<style>


  

    
</style>
@code
{

    [Parameter] public DataBuildUserProfile DataBuild { get => data; set => data=value; }
    private DataBuildUserProfile data = new DataBuildUserProfile();


    protected override async Task OnInitializedAsync()
    {

   
      
    }



    private List<NavItem> NavItems = new()
    {
         new NavItem { Label = "Profile", Url = "settings/profile" },
        new NavItem { Label = "Account", Url = "settings/Account" },
        new NavItem { Label = "Authentication", Url = "settings/authentication" },
        new NavItem { Label = "Organizations", Url = "settings/organizations" },
        new NavItem { Label = "Billing", Url = "settings/billing" },
        new NavItem { Label = "Access Tokens", Url = "settings/AccessTokens" },
        new NavItem { Label = "SSH and GPG Keys", Url = "settings/keys" },
        new NavItem { Label = "Webhooks", Url = "settings/webhooks" },
        new NavItem { Label = "Papers", Url = "settings/papers" },
        new NavItem { Label = "Notifications", Url = "settings/notifications" },
        new NavItem { Label = "Local Apps and ", Url = "settings/local-apps", Badge = "NEW" },
        new NavItem { Label = "Gated Repositories", Url = "settings/gated-repos" },
        new NavItem { Label = "Content Preferences", Url = "settings/content-preferences" },
        new NavItem { Label = "Connected Apps", Url = "settings/applications" },
        new NavItem { Label = "Theme", Url = "settings/theme" }
    };

    [Parameter] public string Url { get; set; } = "profile"; // المسار الافتراضي

    public void SetActiveTab(string url)
    {
        Url = url;
    }

    private RenderFragment RenderComponentBasedOnUrl => builder =>
    {
        if (builder == null)
        {
            throw new ArgumentNullException(nameof(builder));
        }

        if (string.IsNullOrEmpty(Url))
        {
            Url = "settings/profile";
        }

        // قائمة المكونات المرتبطة بكل URL
        var componentMap = new Dictionary<string, Type>
                        {
                { "profile", typeof(ProfileForm) },
                { "Account", typeof(AccountTemplate) },
                { "authentication", typeof(AuthenticationTemplate) },
                { "organizations", typeof(OrganizationsTemplate) },
                { "billing", typeof(BillingSection) },
                { "AccessTokens", typeof(AccessTokensTemplate) },
                { "keys", typeof(SSHandGPGKeysTemplate) },
                { "keys/addtype=ssh", typeof(KeysAddaSSHkey) },
                { "keys/addtype=pgp", typeof(Keysaddapgpp) },
                { "webhooks", typeof(WebhooksTemplate) },
                        { "webhooks/new", typeof(Newwebhook) },

                { "papers", typeof(PapersTemplate) },
                { "notifications", typeof(NotificationsTemplate) },
                { "local-apps", typeof(LocalAppsTemplate) },
                { "gated-repos", typeof(GatedRepositoriesTemplate) },
                { "content-preferences", typeof(ContentPreferencesTemplate) },
                { "applications", typeof(ConnectedAppsTemplate) },
                        { "applications/new", typeof(NewCreateanOAuthapp) },

                { "theme", typeof(ThemeTemplate) }
                        };



    // تحديد المكون بناءً على `url`
    if (componentMap.TryGetValue(Url, out var componentType))
    {
        builder.OpenComponent(0, componentType);
        builder.CloseComponent();
    }
    else
    {
        // مكون افتراضي إذا لم يتم العثور على `url`
            builder.OpenComponent(0, typeof(BillingSection));
        builder.CloseComponent();
    }
    };

    private class NavItem
    {
        public string Label { get; set; }
        public string Url { get; set; }
        public string Badge { get; set; }
    }
}
